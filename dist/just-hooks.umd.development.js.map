{"version":3,"file":"just-hooks.umd.development.js","sources":["../src/useTransferList.ts","../src/utils.ts","../src/useLocalStorage.ts","../src/wrapFetch.ts"],"sourcesContent":["import { useState } from 'react';\n\nconst equalityCompare: (item: any, addOrRemoveItem: any) => boolean = (\n  item,\n  addOrRemoveItem\n) => {\n  const typeofItem = typeof item;\n  const typeofAddOrRemoveItem = typeof addOrRemoveItem;\n\n  if (\n    (typeofItem === 'number' && typeofAddOrRemoveItem === 'number') ||\n    (typeofItem === 'string' && typeofAddOrRemoveItem === 'string')\n  ) {\n    return item === addOrRemoveItem;\n  }\n\n  return item.id === addOrRemoveItem.id;\n};\n\nexport interface KeyedObject {\n  id: string | number;\n}\n\n/**\n *\n * @param initialStartList list of initial start items. Item's type can be number, string or object that has an `id` field\n * @param initialEndList (optional) list of initial end items. Item's type can be number, string or object that has an `id` field\n * @returns\n * {\n *   startList: list of initial items,\n *   endList: list of items that have been transfered to,\n *   transfer(): transfer item to end list,\n *   withdraw(): withdraw item back to start list\n * }\n */\nexport default function useTransferList<\n  T extends number | string | KeyedObject\n>(initialStartList: T[], initialEndList?: T[]) {\n  const [startList, setStartList] = useState<T[]>(initialStartList);\n  const [endList, setEndList] = useState<T[]>(initialEndList || []);\n\n  const transfer = (item: T) => {\n    const index = startList.findIndex(it => equalityCompare(it, item));\n    if (index > -1) {\n      const items = startList.splice(index, 1);\n      setEndList([...endList, ...items]);\n      setStartList(startList);\n    }\n  };\n\n  const withdraw = (item: T) => {\n    const index = endList.findIndex(it => equalityCompare(it, item));\n    if (index > -1) {\n      const items = endList.splice(index, 1);\n      setStartList([...startList, ...items]);\n      setEndList(endList);\n    }\n  };\n\n  return {\n    startList,\n    endList,\n    transfer,\n    withdraw,\n  };\n}\n","/**\n * Keep silent on production. Shout out on other environments.\n */\nexport function logError(...args: unknown[]) {\n  if (process && process.env && process.env.NODE_ENV !== 'production') {\n    console.error(...args);\n  }\n}\n","import { useCallback, useState } from 'react';\nimport { logError } from './utils';\n\n/**\n * Save and retrieve value from local storage\n * @param keyOrFn {string | function} local storage key\n * @param initialValue {T} initial value\n * @param options {Object} provide two optional functions for parsing string to object and stringify object to string.\n */\nexport default function useLocalStorage<T>(\n  keyOrFn: string | (() => string),\n  initialValue: T,\n  options?: { parse?: (strVal: string) => T; stringify?: (val: T) => string }\n): [T, (val: T) => void] {\n  const { parse = JSON.parse, stringify = JSON.stringify } = options || {};\n  const storageKey = typeof keyOrFn === 'function' ? keyOrFn() : keyOrFn;\n\n  const [val, setVal] = useState<T>(() => {\n    try {\n      const storedVal = localStorage.getItem(storageKey);\n      if (storedVal !== null && storedVal !== undefined) {\n        return parse(storedVal);\n      } else {\n        localStorage.setItem(storageKey, stringify(initialValue));\n      }\n    } catch (err) {\n      logError(err);\n    }\n    return initialValue;\n  });\n\n  const saveVal = useCallback(\n    (val: T) => {\n      try {\n        setVal(val);\n        localStorage.setItem(storageKey, stringify(val));\n      } catch (err) {\n        logError(err);\n      }\n    },\n    [setVal]\n  );\n\n  return [val, saveVal];\n}\n","export class APIError<T> extends Error {\n  public data: T | undefined;\n  private code: string | undefined;\n\n  constructor(message: string, code?: string, data?: T) {\n    super(message);\n\n    this.code = code || 'Unknown';\n    this.data = data;\n  }\n\n  public toString() {\n    return `[${this.code}] ${this.message}`;\n  }\n}\nconst getResponseType = (contentType: string) => {\n  if (\n    contentType.indexOf('application/json') > -1 ||\n    contentType.indexOf('application/ld+json') > -1 ||\n    contentType.indexOf('application/vnd.api+json') > -1\n  ) {\n    return 'json';\n  } else if (\n    contentType.indexOf('text/') > -1 ||\n    contentType.indexOf('application/javascript') > -1\n  ) {\n    return 'text';\n  } else if (contentType.indexOf('multipart/form-data') > -1) {\n    return 'formData';\n  } else if (\n    contentType.indexOf('image/') > -1 ||\n    contentType.indexOf('audio/') > -1 ||\n    contentType.indexOf('application/zip') > -1 ||\n    contentType.indexOf('application/pdf') > -1 ||\n    contentType.indexOf('application/msword') > -1\n  ) {\n    return 'blob';\n  } else {\n    return null;\n  }\n};\n\nexport type APIResponse<T = unknown> =\n  | {\n      ok: true;\n      data: T;\n      origin: Response;\n    }\n  | {\n      ok: false;\n      error: APIError<T>;\n      origin?: Response;\n    };\n\nexport async function safeFetch<T = unknown>(\n  input: RequestInfo,\n  init?: RequestInit\n): Promise<APIResponse<T>> {\n  try {\n    const response = await fetch(input, init);\n    const contenttype = response.headers.get('Content-Type');\n    const responseType = contenttype\n      ? getResponseType(contenttype.toLocaleLowerCase())\n      : null;\n\n    let data;\n    let ok = response.ok;\n    if (responseType) {\n      try {\n        data = (await response[responseType]()) as T;\n        if (!response.ok) {\n          data = new APIError(\n            response.statusText,\n            String(response.status),\n            data\n          );\n        }\n      } catch (error) {\n        ok = false;\n        data = new APIError(error.toString());\n      }\n    } else {\n      data = new APIError('Unsupport header content-type: ' + contenttype);\n      ok = false;\n    }\n\n    if (ok) {\n      return {\n        ok: true,\n        data: data as T,\n        origin: response,\n      };\n    } else {\n      return {\n        ok: false,\n        error: data as APIError<T>,\n        origin: response,\n      };\n    }\n  } catch {\n    return {\n      ok: false,\n      error: new APIError('Unexpected error'),\n    };\n  }\n}\n"],"names":["equalityCompare","item","addOrRemoveItem","typeofItem","typeofAddOrRemoveItem","id","useTransferList","initialStartList","initialEndList","startList","setStartList","useState","endList","setEndList","transfer","index","findIndex","it","items","splice","withdraw","logError","args","process","env","console","error","useLocalStorage","keyOrFn","initialValue","options","parse","JSON","stringify","storageKey","val","setVal","storedVal","localStorage","getItem","undefined","setItem","err","saveVal","useCallback","APIError","Error","constructor","message","code","data","toString","getResponseType","contentType","indexOf","safeFetch","input","init","response","fetch","contenttype","headers","get","responseType","toLocaleLowerCase","ok","statusText","String","status","origin"],"mappings":";;;;;;EAEA,MAAMA,eAAe,GAAiD,CACpEC,IADoE,EAEpEC,eAFoE;EAIpE,QAAMC,UAAU,GAAG,OAAOF,IAA1B;EACA,QAAMG,qBAAqB,GAAG,OAAOF,eAArC;;EAEA,MACGC,UAAU,KAAK,QAAf,IAA2BC,qBAAqB,KAAK,QAAtD,IACCD,UAAU,KAAK,QAAf,IAA2BC,qBAAqB,KAAK,QAFxD,EAGE;EACA,WAAOH,IAAI,KAAKC,eAAhB;EACD;;EAED,SAAOD,IAAI,CAACI,EAAL,KAAYH,eAAe,CAACG,EAAnC;EACD,CAfD;EAqBA;;;;;;;;;;;;;;WAYwBC,gBAEtBC,kBAAuBC;EACvB,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BC,cAAQ,CAAMJ,gBAAN,CAA1C;EACA,QAAM,CAACK,OAAD,EAAUC,UAAV,IAAwBF,cAAQ,CAAMH,cAAc,IAAI,EAAxB,CAAtC;;EAEA,QAAMM,QAAQ,GAAIb,IAAD;EACf,UAAMc,KAAK,GAAGN,SAAS,CAACO,SAAV,CAAoBC,EAAE,IAAIjB,eAAe,CAACiB,EAAD,EAAKhB,IAAL,CAAzC,CAAd;;EACA,QAAIc,KAAK,GAAG,CAAC,CAAb,EAAgB;EACd,YAAMG,KAAK,GAAGT,SAAS,CAACU,MAAV,CAAiBJ,KAAjB,EAAwB,CAAxB,CAAd;EACAF,MAAAA,UAAU,CAAC,CAAC,GAAGD,OAAJ,EAAa,GAAGM,KAAhB,CAAD,CAAV;EACAR,MAAAA,YAAY,CAACD,SAAD,CAAZ;EACD;EACF,GAPD;;EASA,QAAMW,QAAQ,GAAInB,IAAD;EACf,UAAMc,KAAK,GAAGH,OAAO,CAACI,SAAR,CAAkBC,EAAE,IAAIjB,eAAe,CAACiB,EAAD,EAAKhB,IAAL,CAAvC,CAAd;;EACA,QAAIc,KAAK,GAAG,CAAC,CAAb,EAAgB;EACd,YAAMG,KAAK,GAAGN,OAAO,CAACO,MAAR,CAAeJ,KAAf,EAAsB,CAAtB,CAAd;EACAL,MAAAA,YAAY,CAAC,CAAC,GAAGD,SAAJ,EAAe,GAAGS,KAAlB,CAAD,CAAZ;EACAL,MAAAA,UAAU,CAACD,OAAD,CAAV;EACD;EACF,GAPD;;EASA,SAAO;EACLH,IAAAA,SADK;EAELG,IAAAA,OAFK;EAGLE,IAAAA,QAHK;EAILM,IAAAA;EAJK,GAAP;EAMD;;ECjED;;;AAGA,WAAgBC,SAAS,GAAGC;EAC1B,MAAIC,OAAO,IAAIA,OAAO,CAACC,GAAnB,IAA0BD,aAAA,KAAyB,YAAvD,EAAqE;EACnEE,IAAAA,OAAO,CAACC,KAAR,CAAc,GAAGJ,IAAjB;EACD;EACF;;ECJD;;;;;;;AAMA,WAAwBK,gBACtBC,SACAC,cACAC;EAEA,QAAM;EAAEC,IAAAA,KAAK,GAAGC,IAAI,CAACD,KAAf;EAAsBE,IAAAA,SAAS,GAAGD,IAAI,CAACC;EAAvC,MAAqDH,OAAO,IAAI,EAAtE;EACA,QAAMI,UAAU,GAAG,OAAON,OAAP,KAAmB,UAAnB,GAAgCA,OAAO,EAAvC,GAA4CA,OAA/D;EAEA,QAAM,CAACO,GAAD,EAAMC,MAAN,IAAgBzB,cAAQ,CAAI;EAChC,QAAI;EACF,YAAM0B,SAAS,GAAGC,YAAY,CAACC,OAAb,CAAqBL,UAArB,CAAlB;;EACA,UAAIG,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAKG,SAAxC,EAAmD;EACjD,eAAOT,KAAK,CAACM,SAAD,CAAZ;EACD,OAFD,MAEO;EACLC,QAAAA,YAAY,CAACG,OAAb,CAAqBP,UAArB,EAAiCD,SAAS,CAACJ,YAAD,CAA1C;EACD;EACF,KAPD,CAOE,OAAOa,GAAP,EAAY;EACZrB,MAAAA,QAAQ,CAACqB,GAAD,CAAR;EACD;;EACD,WAAOb,YAAP;EACD,GAZ6B,CAA9B;EAcA,QAAMc,OAAO,GAAGC,iBAAW,CACxBT,GAAD;EACE,QAAI;EACFC,MAAAA,MAAM,CAACD,GAAD,CAAN;EACAG,MAAAA,YAAY,CAACG,OAAb,CAAqBP,UAArB,EAAiCD,SAAS,CAACE,GAAD,CAA1C;EACD,KAHD,CAGE,OAAOO,GAAP,EAAY;EACZrB,MAAAA,QAAQ,CAACqB,GAAD,CAAR;EACD;EACF,GARwB,EASzB,CAACN,MAAD,CATyB,CAA3B;EAYA,SAAO,CAACD,GAAD,EAAMQ,OAAN,CAAP;EACD;;QC5CYE,iBAAoBC;EAI/BC,EAAAA,YAAYC,SAAiBC,MAAeC;EAC1C,UAAMF,OAAN;EAEA,SAAKC,IAAL,GAAYA,IAAI,IAAI,SAApB;EACA,SAAKC,IAAL,GAAYA,IAAZ;EACD;;EAEMC,EAAAA,QAAQ;EACb,eAAW,KAAKF,SAAS,KAAKD,SAA9B;EACD;;;;EAEH,MAAMI,eAAe,GAAIC,WAAD;EACtB,MACEA,WAAW,CAACC,OAAZ,CAAoB,kBAApB,IAA0C,CAAC,CAA3C,IACAD,WAAW,CAACC,OAAZ,CAAoB,qBAApB,IAA6C,CAAC,CAD9C,IAEAD,WAAW,CAACC,OAAZ,CAAoB,0BAApB,IAAkD,CAAC,CAHrD,EAIE;EACA,WAAO,MAAP;EACD,GAND,MAMO,IACLD,WAAW,CAACC,OAAZ,CAAoB,OAApB,IAA+B,CAAC,CAAhC,IACAD,WAAW,CAACC,OAAZ,CAAoB,wBAApB,IAAgD,CAAC,CAF5C,EAGL;EACA,WAAO,MAAP;EACD,GALM,MAKA,IAAID,WAAW,CAACC,OAAZ,CAAoB,qBAApB,IAA6C,CAAC,CAAlD,EAAqD;EAC1D,WAAO,UAAP;EACD,GAFM,MAEA,IACLD,WAAW,CAACC,OAAZ,CAAoB,QAApB,IAAgC,CAAC,CAAjC,IACAD,WAAW,CAACC,OAAZ,CAAoB,QAApB,IAAgC,CAAC,CADjC,IAEAD,WAAW,CAACC,OAAZ,CAAoB,iBAApB,IAAyC,CAAC,CAF1C,IAGAD,WAAW,CAACC,OAAZ,CAAoB,iBAApB,IAAyC,CAAC,CAH1C,IAIAD,WAAW,CAACC,OAAZ,CAAoB,oBAApB,IAA4C,CAAC,CALxC,EAML;EACA,WAAO,MAAP;EACD,GARM,MAQA;EACL,WAAO,IAAP;EACD;EACF,CAzBD;;AAuCA,EAAO,eAAeC,SAAf,CACLC,KADK,EAELC,IAFK;EAIL,MAAI;EACF,UAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACH,KAAD,EAAQC,IAAR,CAA5B;EACA,UAAMG,WAAW,GAAGF,QAAQ,CAACG,OAAT,CAAiBC,GAAjB,CAAqB,cAArB,CAApB;EACA,UAAMC,YAAY,GAAGH,WAAW,GAC5BR,eAAe,CAACQ,WAAW,CAACI,iBAAZ,EAAD,CADa,GAE5B,IAFJ;EAIA,QAAId,IAAJ;EACA,QAAIe,EAAE,GAAGP,QAAQ,CAACO,EAAlB;;EACA,QAAIF,YAAJ,EAAkB;EAChB,UAAI;EACFb,QAAAA,IAAI,GAAI,MAAMQ,QAAQ,CAACK,YAAD,CAAR,EAAd;;EACA,YAAI,CAACL,QAAQ,CAACO,EAAd,EAAkB;EAChBf,UAAAA,IAAI,GAAG,IAAIL,QAAJ,CACLa,QAAQ,CAACQ,UADJ,EAELC,MAAM,CAACT,QAAQ,CAACU,MAAV,CAFD,EAGLlB,IAHK,CAAP;EAKD;EACF,OATD,CASE,OAAOxB,KAAP,EAAc;EACduC,QAAAA,EAAE,GAAG,KAAL;EACAf,QAAAA,IAAI,GAAG,IAAIL,QAAJ,CAAanB,KAAK,CAACyB,QAAN,EAAb,CAAP;EACD;EACF,KAdD,MAcO;EACLD,MAAAA,IAAI,GAAG,IAAIL,QAAJ,CAAa,oCAAoCe,WAAjD,CAAP;EACAK,MAAAA,EAAE,GAAG,KAAL;EACD;;EAED,QAAIA,EAAJ,EAAQ;EACN,aAAO;EACLA,QAAAA,EAAE,EAAE,IADC;EAELf,QAAAA,IAAI,EAAEA,IAFD;EAGLmB,QAAAA,MAAM,EAAEX;EAHH,OAAP;EAKD,KAND,MAMO;EACL,aAAO;EACLO,QAAAA,EAAE,EAAE,KADC;EAELvC,QAAAA,KAAK,EAAEwB,IAFF;EAGLmB,QAAAA,MAAM,EAAEX;EAHH,OAAP;EAKD;EACF,GAzCD,CAyCE,MAAM;EACN,WAAO;EACLO,MAAAA,EAAE,EAAE,KADC;EAELvC,MAAAA,KAAK,EAAE,IAAImB,QAAJ,CAAa,kBAAb;EAFF,KAAP;EAID;EACF;;;;;;;;;;;;;;;"}